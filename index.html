<!DOCTYPE html>
<meta charset="utf-8">
<style>

svg {
	border: solid 1px #000;
}

circle {
	r: 25;
	stroke: #000;
}

</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js" charset="utf-8"></script>
<body>
<script>
	var width = 500,
		height = 500,
		tau = 2*Math.PI;

	var counts_per_second = 4,
		taus_per_count = 1/8;

	var Hands4 = function(center, radius) {
		this.center = center;
		this.radius = radius;
		this.dancers = [];
	};

	Hands4.prototype.getX = function(pos){
		return this.center[0] + Math.cos(tau/8 + tau/4 * pos + this.dancers[pos].theta * tau) * this.radius;
	}

	Hands4.prototype.getY = function(pos){
		return this.center[1] + Math.sin(tau/8 + tau/4 * pos + this.dancers[pos].theta * tau) * this.radius;
	}

	var svg = d3.select("body").append("svg")
		.attr("width", width)
		.attr("height", height);

	var count_display = d3.select("body").append("p")
		.text(0);

	var h4s = [];
	var h4 = new Hands4([250,250],75);


	var dancers = [];
	for (var i = 0; i < 4; i++) {
		dancers.push(
			{pos: i,
			 theta: 0});
		h4.dancers.push(dancers[i]);
		dancers[i].h4 = h4;
	};
	h4s.push(h4);

	var dots = svg.selectAll("circle")
			.data(dancers)
			.enter().append("circle");


	draw();
	d3.timer(animate);

	function placeDancers(count) {

		for (var i = 0; i < dancers.length; i++) {
			dancers[i].theta = taus_per_count * count;
		}

	}

	function draw(count) {
		
				dots.attr("cx", function(d) {
					return d.h4.getX(d.pos);
				})
				.attr("cy", function(d) {
					return d.h4.getY(d.pos);
				})
				.attr("fill", function(d) {
					return "#" +d.pos * 222;
				});
				count_display.text(Math.floor(count) % 8);
	}

	function animate(elapsed) {
		var count = elapsed/1000 * counts_per_second;
		placeDancers(count);
		draw(count);
	}

</script>
